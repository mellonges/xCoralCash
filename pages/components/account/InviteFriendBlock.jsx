import { AnimatePresence, motion } from "framer-motion";
import moment from "moment";
import Link from "next/link";
import { useEffect, useState } from "react";

import styles from "../../../styles/components/Account/InviteFriendsBlock.module.scss";
import InviteForm from "./InviteForm";

const InviteFriendBlock = ({}) => {
  const [isOpen, setIsOpen] = useState(false);

  useEffect(() => {
    if (!localStorage.getItem("hideInvite")) setIsOpen(true);
    else {
      var duration = moment.duration(
        moment().diff(localStorage.getItem("hideInvite"))
      );
      var hours = duration.asHours();

      if (hours >= 48) setIsOpen(true);
    }
  }, []);

  return (
    <AnimatePresence>
      {isOpen ? (
        <motion.div
          className={styles.InviteFriendBlockWrapper}
          exit={{ opacity: 0 }}
        >
          <div
            className={`${styles.InviteFriendBlock} d-flex align-items-center`}
          >
            <div className={`${styles.IconBlock} text-center`}>
              <svg
                width="123"
                height="123"
                viewBox="0 0 123 123"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle cx="61.0755" cy="61.0755" r="61.0755" fill="white" />
                <path
                  d="M77.3928 41.0663C75.627 37.7643 73.5119 36.0908 71.1055 36.0908C68.3356 36.0908 65.4589 38.3541 62.5524 42.8212C62.1805 43.3929 61.8322 43.9646 61.5111 44.5165C61.19 43.9646 60.8417 43.3929 60.4691 42.8212C57.5643 38.3541 54.6867 36.0908 51.9167 36.0908C49.5105 36.0908 47.3945 37.7643 45.6296 41.0663C44.3098 43.5377 44.7856 45.3126 45.4171 46.3656C46.555 48.2635 49.0989 49.5427 53.1941 50.2736C56.3385 50.8362 59.6658 50.9195 61.3692 50.9195H61.3701C61.418 50.9195 61.465 50.9195 61.5113 50.9195C61.5583 50.9195 61.6053 50.9195 61.6533 50.9195C63.3568 50.9195 66.684 50.8362 69.8286 50.2736C73.9228 49.5427 76.4667 48.2635 77.6066 46.3656C78.2359 45.3126 78.7136 43.5377 77.3928 41.0663Z"
                  fill="#00C9A5"
                />
                <path
                  d="M87.448 59.955C87.448 58.5908 86.3407 57.4854 84.9764 57.4854H38.0436C36.6794 57.4854 35.5731 58.5908 35.5731 59.955V89.2015C35.5731 90.5657 36.6794 91.6711 38.0436 91.6711H84.9766C86.3407 91.6711 87.4481 90.5657 87.4481 89.2015V59.955H87.448Z"
                  fill="#0F8D84"
                />
                <path
                  d="M91.1534 62.0283C91.1534 63.3925 90.0462 64.498 88.682 64.498H34.3385C32.9743 64.4979 31.8679 63.3924 31.8679 62.0282V49.6766C31.8679 48.3124 32.9743 47.2051 34.3385 47.2051H88.6821C90.0463 47.2051 91.1535 48.3123 91.1535 49.6766V62.0283H91.1534Z"
                  fill="#28B6AC"
                />
                <path
                  d="M67.6885 47.2051H55.3355V64.4955H67.6885V47.2051Z"
                  fill="#49E9CC"
                />
                <path
                  d="M35.5731 66.9437L87.448 71.6604V64.5791H35.5731V66.9437Z"
                  fill="#0D6660"
                />
                <path
                  d="M67.6885 64.4971H55.3355V91.6706H67.6885V64.4971Z"
                  fill="#49E9CC"
                />
                <path
                  d="M55.3355 68.7403L67.6883 69.8639V64.5791H55.3355V68.7403Z"
                  fill="#31A691"
                />
                <path
                  d="M24.6001 90.5851L25.3649 90.6829C26.3743 90.812 26.8324 89.4622 25.953 88.9502L25.2867 88.5622C23.608 87.5848 22.6773 85.6976 22.9237 83.7708L23.0215 83.006C23.1505 81.9966 21.8007 81.5385 21.2887 82.4179L20.9008 83.0842C19.9234 84.7629 18.0362 85.6937 16.1094 85.4473L15.3446 85.3495C14.3352 85.2204 13.877 86.5702 14.7564 87.0822L15.4228 87.4701C17.1015 88.4475 18.0322 90.3347 17.7858 92.2616L17.688 93.0264C17.5589 94.0357 18.9088 94.4939 19.4208 93.6145L19.8087 92.9482C20.7861 91.2694 22.6733 90.3387 24.6001 90.5851Z"
                  fill="#FFC34F"
                />
                <path
                  d="M104.346 31.6184L107.49 30.3972C108.975 29.8205 108.596 27.6224 107.005 27.5752L103.633 27.4754C100.31 27.3771 97.3692 25.2997 96.1657 22.2012L94.9444 19.0568C94.3678 17.5724 92.1697 17.9508 92.1225 19.5425L92.0227 22.9142C91.9243 26.2368 89.847 29.1779 86.7484 30.3814L83.6041 31.6027C82.1197 32.1793 82.498 34.3775 84.0898 34.4247L87.4615 34.5245C90.7841 34.6228 93.7252 36.7002 94.9287 39.7987L96.15 42.9431C96.7266 44.4275 98.9248 44.0491 98.972 42.4574L99.0717 39.0857C99.17 35.7631 101.247 32.8221 104.346 31.6184Z"
                  fill="#FFC34F"
                />
                <path
                  d="M116.897 81.6014L119.665 81.6096C120.972 81.6134 121.341 79.8209 120.139 79.3083L117.593 78.2228C115.084 77.1531 113.459 74.6857 113.467 71.9583L113.475 69.1905C113.479 67.8839 111.686 67.515 111.174 68.7169L110.088 71.2629C109.018 73.7718 106.551 75.3968 103.824 75.3888L101.056 75.3805C99.7493 75.3767 99.3803 77.1693 100.582 77.6818L103.128 78.7673C105.637 79.837 107.262 82.3044 107.254 85.0319L107.246 87.7996C107.242 89.1062 109.035 89.4752 109.547 88.2733L110.633 85.7273C111.702 83.2184 114.17 81.5934 116.897 81.6014Z"
                  fill="#FFC34F"
                />
                <path
                  d="M25.9644 41.3802L28.8008 41.356C30.1399 41.3446 30.497 39.5031 29.2591 38.9921L26.6373 37.9096C24.0536 36.8428 22.3592 34.3336 22.3354 31.5384L22.3111 28.702C22.2997 27.3629 20.4582 27.0059 19.9474 28.2437L18.8649 30.8656C17.7981 33.4493 15.2888 35.1437 12.4936 35.1675L9.65717 35.1917C8.31808 35.2031 7.96105 37.0446 9.19887 37.5556L11.8207 38.6381C14.4045 39.7049 16.0988 42.2141 16.1227 45.0093L16.1469 47.8457C16.1583 49.1848 17.9998 49.5418 18.5107 48.304L19.5932 45.6821C20.6599 43.0985 23.1695 41.4041 25.9644 41.3802Z"
                  fill="#FFC34F"
                />
              </svg>
            </div>
            <div className={`${styles.textBlock}`}>
              <strong className={styles.title}>
                Invite Friends. Earn Rewards
              </strong>
              <div className={styles.descr}>
                Both you and your friend will be eligible for{" "}
                <strong>$5</strong> worth of tokens of random person traded on
                the platform.{" "}
                <Link href="/account/invite">
                  <a>Learn more</a>
                </Link>
              </div>
              <InviteForm styles={styles} />
            </div>
            <div className={`${styles.textBlock} align-self-start ml-auto`}>
              <a
                href="#"
                className={styles.closeBtn}
                onClick={() => {
                  setIsOpen(false);
                  localStorage.setItem("hideInvite", moment());
                }}
              >
                <svg
                  width="13"
                  height="13"
                  viewBox="0 0 13 13"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7.69099 6.5001L12.7529 1.4379C13.0824 1.10862 13.0824 0.576231 12.7529 0.246956C12.4237 -0.0823187 11.8913 -0.0823187 11.562 0.246956L6.49992 5.30915L1.43798 0.246956C1.10856 -0.0823187 0.576335 -0.0823187 0.247067 0.246956C-0.0823556 0.576231 -0.0823556 1.10862 0.247067 1.4379L5.30901 6.5001L0.247067 11.5623C-0.0823556 11.8916 -0.0823556 12.424 0.247067 12.7532C0.411161 12.9175 0.62692 13 0.842525 13C1.05813 13 1.27374 12.9175 1.43798 12.7532L6.49992 7.69104L11.562 12.7532C11.7263 12.9175 11.9419 13 12.1575 13C12.3731 13 12.5887 12.9175 12.7529 12.7532C13.0824 12.424 13.0824 11.8916 12.7529 11.5623L7.69099 6.5001Z"
                    fill="#779197"
                  />
                </svg>
              </a>
            </div>
          </div>
        </motion.div>
      ) : null}
    </AnimatePresence>
  );
};
export default InviteFriendBlock;
